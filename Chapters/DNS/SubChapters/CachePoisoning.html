<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cache Poisoning: Exploiting DNS Caching Vulnerabilities</title>
  <!-- Google Fonts for Montserrat and Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <!-- Link to main stylesheet -->
  <link rel="stylesheet" href="../SubChapters/SubChapter.css">
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <div class="logo">CODING OVER COLLEGE</div>
    <nav class="nav-links">
      <ul>
        <li class="dropdown">
          <button class="dropbtn">Chapters</button>
          <div class="dropdown-content">
            <a href="../../DataStructures/DataStructures.html">Data Structures</a>
            <a href="../../NamedAlgorithms/NamedAlgorithms.html">Named Algorithms</a>
            <a href="../../PythonLibraries/PythonLibraries.html">Python Libraries</a>
            <a href="../../DNS/DNS.html">DNS</a>
            <a href="../../ConcurrencyAndThreads/ConcurrencyAndThreads.html">Concurrency &amp; Threads</a>
            <a href="../../AlgorithmicComplexity/AlgorithmicComplexity.html">Algorithmic Complexity</a>
          </div>
        </li>
        <li><a href="../../References/References.html">Resources</a></li>
        <li><a href="donate.html">Community</a></li>
        <li><a href="../../../index.html">Home</a></li>
      </ul>
    </nav>
    <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open Menu">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>
    <nav class="mobile-nav-links" id="mobileNav">
      <ul>
        <li class="dropdown">
          <button class="dropbtn mobile-dropbtn">Chapters</button>
          <div class="dropdown-content mobile-dropdown-content">
            <a href="../../DataStructures/DataStructures.html">Data Structures</a>
            <a href="../../NamedAlgorithms/NamedAlgorithms.html">Named Algorithms</a>
            <a href="../../PythonLibraries/PythonLibraries.html">Python Libraries</a>
            <a href="../../DNS/DNS.html">DNS</a>
            <a href="../../ConcurrencyAndThreads/ConcurrencyAndThreads.html">Concurrency &amp; Threads</a>
            <a href="../../AlgorithmicComplexity/AlgorithmicComplexity.html">Algorithmic Complexity</a>
          </div>
        </li>
        <li><a href="../../References/References.html">Resources</a></li>
        <li><a href="#">Community</a></li>
        <li><a href="../../../index.html">Home</a></li>
      </ul>
    </nav>
    <div class="user-profile">
      <a href="#" class="btn-login">Donate</a>
    </div>
  </header>

  <!-- Progress Bar -->
  <div class="progress-bar"></div>

  <!-- HERO SECTION -->
  <section class="hero">
    <div class="hero-content">
      <h1>Cache Poisoning: Exploiting DNS Caching Vulnerabilities</h1>
      <p class="chapter-subtext">
        Learn how attackers exploit DNS caching to redirect users to malicious sites and how to protect your DNS infrastructure.
      </p>
      <p class="reading-time">Estimated reading time: calculating...</p>
    </div>
    <div class="hero-graphic">
      <div class="animated-bg"></div>
    </div>
  </section>

  <!-- THREE-COLUMN LAYOUT -->
  <div class="three-column-container">
    <!-- Left Sidebar: Subchapters -->
    <aside class="sidebar-subchapters">
      <h2>Subchapters</h2>
      <ul>
        <li><a href="../SubChapters/Resolvers.html">Resolvers</a></li>
        <li><a href="../SubChapters/Caching.html">Caching</a></li>
        <li><a href="../SubChapters/ZoneFiles.html">Zone Files</a></li>
        <li><a href="../SubChapters/IPAddress.html">IP Addresses</a></li>
        <li><a href="../SubChapters/Proticals.html">Proticals</a></li>
        <li><a href="../SubChapters/Ports.html">Ports</a></li>
        <li><a href="../SubChapters/PublicDNS.html">Public DNS</a></li>
        <li><a href="../SubChapters/PrivateDNS.html">Private DNS</a></li>
        <li><a href="../SubChapters/DomainRegistration.html">Domain Registration</a></li>
        <li><a href="../SubChapters/HostingProvider.html">Hosting Providers</a></li>
        <li><a href="../SubChapters/nslookup.html">nslookup</a></li>
        <li><a href="../SubChapters/ServerSetup.html">Server Setup</a></li>
        <li><a href="../SubChapters/DNSSEC.html">DNSSEC</a></li>
        <li><a href="../SubChapters/CachePoisoning.html" class="active">Cache Poisoning</a></li>
        <li><a href="../SubChapters/SpoofingAttacks.html">Spoofing Attacks</a></li>
        <li><a href="../SubChapters/DoH.html">DNS over HTTPS</a></li>
        <li><a href="../SubChapters/DoT.html">DNS over TLS</a></li>
        <li><a href="../SubChapters/DigforTroubleshooting.html">Dig for Troubleshooting</a></li>
        <li><a href="../SubChapters/Advancenslookup.html">Advance nslookup</a></li>
        <li><a href="../SubChapters/Wireshark.html">Wireshark</a></li>
        <li><a href="../SubChapters/ResolvingDomainFailures.html">Resolving Domain Failures</a></li>
        <li><a href="../SubChapters/CheckingDNSPropagation.html">Checking DNS Propagation</a></li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="chapter-content">
      <div class="subchapterBody">
        <!-- Section 1: Introduction -->
        <section class="preface-section fade-in" id="introduction">
          <h4>Introduction</h4>
          <p>
            DNS caching improves performance by storing DNS responses locally to reduce lookup times. However, <strong>Cache Poisoning</strong> (also known as <strong>DNS Spoofing</strong>) is a critical vulnerability where attackers inject fraudulent DNS responses into a resolver’s cache, redirecting users to malicious websites without their knowledge.
          </p>
        </section>

        <!-- Section 2: What is Cache Poisoning? -->
        <section class="preface-section fade-in" id="what-is-cache-poisoning">
          <h4>What is Cache Poisoning?</h4>
          <h3>Definition</h3>
          <p>
            Cache poisoning is a cyberattack that corrupts a DNS resolver’s cache by inserting malicious DNS records. As a result, users querying the domain receive fraudulent IP addresses rather than the legitimate ones.
          </p>
          <h3>Why is Cache Poisoning Dangerous?</h3>
          <ul>
            <li><strong>Redirects to Malicious Websites:</strong> Facilitates phishing and malware distribution.</li>
            <li><strong>Intercepts Credentials:</strong> Can steal sensitive login and financial data.</li>
            <li><strong>Enables MITM Attacks:</strong> Allows attackers to intercept encrypted traffic.</li>
            <li><strong>Disrupts Critical Services:</strong> Can be used to attack large-scale infrastructures.</li>
          </ul>
        </section>

        <!-- Section 3: How Cache Poisoning Works -->
        <section class="preface-section fade-in" id="how-cache-poisoning-works">
          <h4>How Cache Poisoning Works</h4>
          <p>
            Cache poisoning exploits vulnerabilities in DNS resolution. An attacker sends a DNS query to a resolver and simultaneously floods it with fake DNS responses containing fraudulent IP addresses. If the resolver caches the fake response before receiving the legitimate one, subsequent queries receive the malicious data.
          </p>
          <h3>Step-by-Step Attack Process</h3>
          <ol>
            <li><strong>Attacker sends a DNS query</strong> for a specific domain.</li>
            <li><strong>Floods the resolver</strong> with fake responses containing malicious IP addresses.</li>
            <li><strong>Resolver caches</strong> the first valid response it receives—even if fraudulent.</li>
            <li><strong>Subsequent users</strong> receive the poisoned record, redirecting them to a malicious site.</li>
          </ol>
          <h3>Example of a Poisoned DNS Record</h3>
          <p>Legitimate response:</p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">example.com.  3600  IN  A  93.184.216.34  # Correct IP</pre>
          </div>
          <p>Poisoned response:</p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">example.com.  3600  IN  A  192.0.2.123  # Malicious IP</pre>
          </div>
        </section>

        <!-- Section 4: Attack Techniques -->
        <section class="preface-section fade-in" id="attack-techniques">
          <h4>Attack Techniques</h4>
          <h3>Birthday Attack (Race Condition)</h3>
          <p>
            Attackers flood the resolver with forged responses, increasing the chance of a successful poisoning by exploiting simultaneous requests.
          </p>
          <h3>Kaminsky Attack (Random Subdomain Attack)</h3>
          <p>
            By generating random subdomains, attackers force repeated DNS queries and inject malicious responses before the legitimate ones arrive.
          </p>
          <h3>Man-in-the-Middle (MITM) DNS Spoofing</h3>
          <p>
            Intercepting DNS queries between the client and resolver allows attackers to modify responses on the fly without altering the local cache.
          </p>
          <h3>Rogue DHCP Server Attack</h3>
          <p>
            A malicious DHCP server assigns compromised DNS settings to devices, causing them to use poisoned DNS servers.
          </p>
        </section>

        <!-- Section 5: Real-World Consequences -->
        <section class="preface-section fade-in" id="real-world-consequences">
          <h4>Real-World Consequences of Cache Poisoning</h4>
          <table class="comparison-table">
            <thead>
              <tr>
                <th>Incident</th>
                <th>Impact</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>2008 Kaminsky Attack</strong></td>
                <td>Affected millions of DNS servers worldwide, prompting emergency patches.</td>
              </tr>
              <tr>
                <td><strong>Google Brazil Hijack (2014)</strong></td>
                <td>Redirected users to a defaced website via poisoned DNS responses.</td>
              </tr>
              <tr>
                <td><strong>MyEtherWallet Attack (2018)</strong></td>
                <td>$150,000 in cryptocurrency was stolen through cache poisoning.</td>
              </tr>
              <tr>
                <td><strong>Amazon Route 53 Hijack (2018)</strong></td>
                <td>Disrupted major cloud services and redirected users to malicious sites.</td>
              </tr>
            </tbody>
          </table>
        </section>

        <!-- Section 6: Preventing Cache Poisoning -->
        <section class="preface-section fade-in" id="preventing-cache-poisoning">
          <h4>Preventing Cache Poisoning</h4>
          <h3>1. Implement DNSSEC</h3>
          <p>
            DNSSEC digitally signs DNS responses, making it much harder for attackers to forge records.
          </p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">sudo apt install bind9-dnssec-tools</pre>
          </div>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">dig +dnssec example.com</pre>
          </div>
          <h3>2. Use Randomized Query IDs and Source Ports</h3>
          <p>
            Enabling port randomization reduces the success rate of forging DNS responses.
          </p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">
options {
    query-source address * port 1024-65535;
};
            </pre>
          </div>
          <h3>3. Restrict Recursive DNS Queries</h3>
          <p>
            Prevent open resolvers from serving unauthorized clients by disabling recursion.
          </p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">
options {
    allow-recursion { none; };
};
            </pre>
          </div>
          <h3>4. Enable Encrypted DNS (DoT/DoH)</h3>
          <p>
            Encrypt DNS queries to prevent MITM attacks.
          </p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">
server:
    do-tls: yes
    forward-zone:
        name: "."
        forward-addr: 1.1.1.1@853
            </pre>
          </div>
          <h3>5. Reduce TTL for Sensitive Records</h3>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">example.com.  300  IN  A  93.184.216.34</pre>
          </div>
          <h3>6. Monitor and Detect DNS Anomalies</h3>
          <p>
            Use SIEM and network monitoring tools (e.g., Zeek, Suricata) to log and detect suspicious DNS activity.
          </p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">sudo tail -f /var/log/named/security.log</pre>
          </div>
        </section>

        <!-- Section 7: Testing for Cache Poisoning Vulnerabilities -->
        <section class="preface-section fade-in" id="testing-cache-poisoning">
          <h4>Testing for Cache Poisoning Vulnerabilities</h4>
          <h3>1. Check if a Resolver is Open</h3>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">dig ANY example.com @public-resolver</pre>
          </div>
          <h3>2. Test Cache Poisoning Resistance</h3>
          <p>
            Query multiple times to detect inconsistencies:
          </p>
          <div class="code-block">
            <button class="copy-btn">Copy</button>
            <pre class="code-snippet">
for i in {1..5}; do
    dig example.com
    sleep 1
done
            </pre>
          </div>
        </section>

        <!-- Section 8: Conclusion -->
        <section class="preface-section fade-in" id="conclusion">
          <h4>Conclusion</h4>
          <p>
            Cache poisoning is a severe threat that exploits DNS caching vulnerabilities to redirect users to malicious sites. By implementing DNSSEC, randomizing query parameters, restricting recursion, enabling encrypted DNS, and actively monitoring for anomalies, organizations can significantly reduce the risk of such attacks.
          </p>
        </section>

        <!-- Section 9: Next Steps -->
        <section class="preface-section fade-in" id="next-steps">
          <h4>Next Steps</h4>
          <ul>
            <li>Enable DNSSEC on your domain to prevent forged responses.</li>
            <li>Configure randomized query IDs and source ports.</li>
            <li>Restrict recursive DNS queries to trusted clients only.</li>
            <li>Implement DNS-over-TLS or DNS-over-HTTPS to encrypt queries.</li>
            <li>Monitor DNS logs and use testing tools to check for poisoning vulnerabilities.</li>
          </ul>
        </section>
      </div>
      <!-- Next Chapter Navigation -->
      <div class="next-chapter" style="text-align: right; margin-top: 2rem;">
        <a href="../SubChapters/SpoofingAttacks.html" class="chapter-btn">
          Next Chapter <i class="fas fa-arrow-right"></i>
        </a>
      </div>
    </main>

    <!-- Right Sidebar: Table of Contents -->
    <aside class="sidebar-toc">
      <h2>Contents</h2>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#what-is-cache-poisoning">What is Cache Poisoning?</a></li>
        <li><a href="#how-cache-poisoning-works">How Cache Poisoning Works</a></li>
        <li><a href="#attack-techniques">Attack Techniques</a></li>
        <li><a href="#real-world-consequences">Real-World Consequences</a></li>
        <li><a href="#preventing-cache-poisoning">Preventing Cache Poisoning</a></li>
        <li><a href="#testing-cache-poisoning">Testing for Vulnerabilities</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
        <li><a href="#next-steps">Next Steps</a></li>
      </ul>
    </aside>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-content">
      <p>© 2025 Coding Over College</p>
      <ul class="footer-links">
        <li><a href="#">About</a></li>
        <li><a href="#">Contact</a></li>
        <li><a href="#">Privacy Policy</a></li>
      </ul>
      <p>
        Inspired by <a href="https://www.w3schools.com/" target="_blank">W3Schools</a>,
        <a href="https://www.youtube.com/c/fireship" target="_blank">Fireship</a> &
        <a href="https://www.youtube.com/c/juxtoposed" target="_blank">Juxtoposed</a>.
      </p>
    </div>
  </footer>

  <!-- Back to Top Button -->
  <button id="backToTop" class="back-to-top">↑</button>

  <!-- JavaScript -->
  <script defer src="../../../script.js"></script>
</body>
</html>
